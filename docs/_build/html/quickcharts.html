<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Chart Views &mdash; Flask AppBuilder</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Flask AppBuilder" href="index.html" />
    <link rel="next" title="Model Views with Files and Images" href="quickfiles.html" />
    <link rel="prev" title="Model Views on MongoDB" href="quickhowto_mongo.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">
  
  <a href="https://github.com/dpgaspar/Flask-AppBuilder"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar  navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Flask-AppBuilder</a>
        <span class="navbar-text navbar-version pull-left"><b>1.5.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="diagrams.html">Diagrams</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="fabmanager.html">Command Line Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Base Configuration</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="views.html">Base Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickhowto.html">Model Views (Quick How to)</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickhowto_mongo.html">Model Views on MongoDB</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Chart Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickfiles.html">Model Views with Files and Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickminimal.html">Quick Minimal Application</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="relations.html">Model Relations</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="customizing.html">Customizing</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="generic_datasource.html">Generic Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="multipledbs.html">Multiple Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">i18n Translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_registration.html">User Registration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="versionmigration.html">Version Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Versions</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Chart Views</a><ul>
<li><a class="reference internal" href="#direct-data-charts">Direct Data Charts</a></li>
<li><a class="reference internal" href="#grouped-data-charts">Grouped Data Charts</a></li>
<li><a class="reference internal" href="#deprecated-define-your-chart-views-views-py">(Deprecated) Define your Chart Views (views.py)</a></li>
<li><a class="reference internal" href="#register-views-py">Register (views.py)</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="quickhowto_mongo.html" title="Previous Chapter: Model Views on MongoDB"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Model Views o...</span>
    </a>
  </li>
  <li>
    <a href="quickfiles.html" title="Next Chapter: Model Views with Files and Images"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Model Views w... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="chart-views">
<h1>Chart Views<a class="headerlink" href="#chart-views" title="Permalink to this headline">¶</a></h1>
<p>To implement views with google charts, use all inherited classes from BaseChartView, these are:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">DirectChartView:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Display direct data charts with multiple series, no group by is applied.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">GroupByChartView:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">Displays grouped data with multiple series.</td>
</tr>
<tr class="field-odd field"><th class="field-name">ChartView:</th><td class="field-body">(Deprecated) Display simple group by method charts.</td>
</tr>
<tr class="field-even field"><th class="field-name">TimeChartView:</th><td class="field-body">(Deprecated) Displays simple group by month and year charts.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>You can experiment with some examples on a live
<a class="reference external" href="http://flaskappbuilder.pythonanywhere.com/">Demo</a> (login has guest/welcome).</p>
<div class="section" id="direct-data-charts">
<h2>Direct Data Charts<a class="headerlink" href="#direct-data-charts" title="Permalink to this headline">¶</a></h2>
<p>These charts can display multiple series, based on columns or methods defined on models.
You can display multiple charts on the same view.</p>
<p>Let&#8217;s create a simple model first, the gold is to display a chart showing the unemployment evolution
versus the percentage of the population with higher education, our model will be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CountryStats</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">stat_date</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">population</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">unemployed_perc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">poor_perc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">college</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
</pre></div>
</div>
<p>Suppose that the college field will have the total number of college students on some date.
But the <em>unemployed_perc</em> field holds a percentage, we can&#8217;t draw a chart with these two together,
we must create a function to calculate the <em>college_perc</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">college_perc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">college</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>Now we are ready to define our view:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.ext.appbuilder.charts.views</span> <span class="kn">import</span> <span class="n">DirectByChartView</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.model.sqla.interface</span> <span class="kn">import</span> <span class="n">SQLAInterface</span>

<span class="k">class</span> <span class="nc">CountryDirectChartView</span><span class="p">(</span><span class="n">DirectByChartView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">CountryStats</span><span class="p">)</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="s">&#39;Direct Data Example&#39;</span>

    <span class="n">definitions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s">&#39;label&#39;</span><span class="p">:</span> <span class="s">&#39;Unemployment&#39;</span><span class="p">,</span>
        <span class="s">&#39;group&#39;</span><span class="p">:</span> <span class="s">&#39;stat_date&#39;</span><span class="p">,</span>
        <span class="s">&#39;series&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;unemployed_perc&#39;</span><span class="p">,</span>
                   <span class="s">&#39;college_perc&#39;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This view definition will produce this:</p>
<a class="reference internal image-reference" href="_images/direct_chart.png"><img alt="_images/direct_chart.png" src="_images/direct_chart.png" style="width: 100%;" /></a>
<p>The <strong>definitions</strong> property respects the following grammar:</p>
<div class="highlight-python"><div class="highlight"><pre>definitions = [
                {
                 &#39;label&#39;: &#39;label for chart definition&#39;,
                 &#39;group&#39;: &#39;&lt;COLNAME&gt;&#39;|&#39;&lt;MODEL FUNCNAME&gt;&#39;,
                 &#39;formatter&#39;: &lt;FUNC FORMATTER FOR GROUP COL&gt;,
                 &#39;series&#39;: [&#39;&lt;COLNAME&gt;&#39;|&#39;&lt;MODEL FUNCNAME&gt;&#39;,...]
                }, ...
              ]
</pre></div>
</div>
<p>Where &#8216;label&#8217; and &#8216;formatter&#8217; are optional parameters.
So on the same view you can have multiple direct chart definitions, like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.ext.appbuilder.charts.views</span> <span class="kn">import</span> <span class="n">DirectByChartView</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.model.sqla.interface</span> <span class="kn">import</span> <span class="n">SQLAInterface</span>

<span class="k">class</span> <span class="nc">CountryDirectChartView</span><span class="p">(</span><span class="n">DirectByChartView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">CountryStats</span><span class="p">)</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="s">&#39;Direct Data Example&#39;</span>

    <span class="n">definitions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s">&#39;label&#39;</span><span class="p">:</span> <span class="s">&#39;Unemployment&#39;</span><span class="p">,</span>
        <span class="s">&#39;group&#39;</span><span class="p">:</span> <span class="s">&#39;stat_date&#39;</span><span class="p">,</span>
        <span class="s">&#39;series&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;unemployed_perc&#39;</span><span class="p">,</span>
                   <span class="s">&#39;college_perc&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s">&#39;label&#39;</span><span class="p">:</span> <span class="s">&#39;Poor&#39;</span><span class="p">,</span>
        <span class="s">&#39;group&#39;</span><span class="p">:</span> <span class="s">&#39;stat_date&#39;</span><span class="p">,</span>
        <span class="s">&#39;series&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;poor_perc&#39;</span><span class="p">,</span>
                   <span class="s">&#39;college_perc&#39;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Next register your view like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">CountryDirectChartView</span><span class="p">,</span> <span class="s">&quot;Show Country Chart&quot;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s">&quot;fa-dashboard&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s">&quot;Statistics&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This kind of chart inherits from <strong>BaseChartView</strong> that has some properties that you can configure
these are:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">chart_title:</th><td class="field-body">The Title of the chart (can be used with babel of course).</td>
</tr>
<tr class="field-even field"><th class="field-name">group_by_label:</th><td class="field-body">The label that will be displayed before the buttons for choosing the chart.</td>
</tr>
<tr class="field-odd field"><th class="field-name">chart_type:</th><td class="field-body">The chart type PieChart, ColumnChart or LineChart</td>
</tr>
<tr class="field-even field"><th class="field-name">chart_3d:</th><td class="field-body">= True or false label like: &#8216;true&#8217;</td>
</tr>
<tr class="field-odd field"><th class="field-name">width:</th><td class="field-body">The charts width</td>
</tr>
<tr class="field-even field"><th class="field-name">height:</th><td class="field-body">The charts height</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additionally you can configure <strong>BaseModelView</strong> properties because <strong>BaseChartView</strong> is a child.
The most interesting one is</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">base_filters:</th><td class="field-body">Defines the filters for data, this has precedence from all UI filters.</td>
</tr>
<tr class="field-even field"><th class="field-name">label_columns:</th><td class="field-body">Labeling for charts columns. If not provided the framework will
generate a pretty version of the columns name.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="grouped-data-charts">
<h2>Grouped Data Charts<a class="headerlink" href="#grouped-data-charts" title="Permalink to this headline">¶</a></h2>
<p>These charts can display multiple series, based on columns from models or functions defined on the models.
You can display multiple charts on the same view. This data can be grouped and aggregated has you like.</p>
<p>Let&#8217;s create some simple models first, base on the prior example but this time lets make our models
support has many countries has we like.
The gold is to display a chart showing the unemployment
versus the percentage of the population with higher education per country:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.ext.appbuilder</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Country</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


<span class="k">class</span> <span class="nc">CountryStats</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">stat_date</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">population</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">unemployed_perc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">poor_perc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">college</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Float</span><span class="p">)</span>
    <span class="n">country_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;country.id&#39;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s">&quot;Country&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">college_perc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">college</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">month_year</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stat_date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we are ready to define our view:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask.ext.appbuilder.charts.views</span> <span class="kn">import</span> <span class="n">GroupByChartView</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.models.group</span> <span class="kn">import</span> <span class="n">aggregate_count</span><span class="p">,</span> <span class="n">aggregate_sum</span><span class="p">,</span> <span class="n">aggregate_avg</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.model.sqla.interface</span> <span class="kn">import</span> <span class="n">SQLAInterface</span>


<span class="k">class</span> <span class="nc">CountryGroupByChartView</span><span class="p">(</span><span class="n">GroupByChartView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">CountryStats</span><span class="p">)</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="s">&#39;Statistics&#39;</span>

    <span class="n">definitions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&#39;label&#39;</span><span class="p">:</span> <span class="s">&#39;Country Stat&#39;</span><span class="p">,</span>
            <span class="s">&#39;group&#39;</span><span class="p">:</span> <span class="s">&#39;country&#39;</span><span class="p">,</span>
            <span class="s">&#39;series&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="n">aggregate_avg</span><span class="p">,</span> <span class="s">&#39;unemployed_perc&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">aggregate_avg</span><span class="p">,</span> <span class="s">&#39;population&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">aggregate_avg</span><span class="p">,</span> <span class="s">&#39;college_perc&#39;</span><span class="p">)</span>
                      <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>Next register your view like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">CountryGroupByChartView</span><span class="p">,</span> <span class="s">&quot;Show Country Chart&quot;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s">&quot;fa-dashboard&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s">&quot;Statistics&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>F.A.B. has already some aggregation functions that you can use, for count, sum and average.
On this example we are using average, this will display the historical average of
unemployment and college formation, grouped by country.</p>
<p>A different and interesting example is to group data monthly from all countries, this will show the use of
<strong>formater</strong> property:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.charts.views</span> <span class="kn">import</span> <span class="n">GroupByChartView</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.models.group</span> <span class="kn">import</span> <span class="n">aggregate_count</span><span class="p">,</span> <span class="n">aggregate_sum</span><span class="p">,</span> <span class="n">aggregate_avg</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.model.sqla.interface</span> <span class="kn">import</span> <span class="n">SQLAInterface</span>

<span class="k">def</span> <span class="nf">pretty_month_year</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">month</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CountryGroupByChartView</span><span class="p">(</span><span class="n">GroupByChartView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">CountryStats</span><span class="p">)</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="s">&#39;Statistics&#39;</span>

    <span class="n">definitions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&#39;group&#39;</span><span class="p">:</span> <span class="s">&#39;month_year&#39;</span><span class="p">,</span>
            <span class="s">&#39;formatter&#39;</span><span class="p">:</span> <span class="n">pretty_month_year</span><span class="p">,</span>
            <span class="s">&#39;series&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="n">aggregate_avg</span><span class="p">,</span> <span class="s">&#39;unemployed_perc&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">aggregate_avg</span><span class="p">,</span> <span class="s">&#39;college_perc&#39;</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>This view will group data based on the model&#8217;s method <em>month_year</em> that has the name says will group data
by month and year, this grouping will be processed by averaging data from <em>unemployed_perc</em> and <em>college_perc</em>.</p>
<p>The group criteria will be formatted for display by <em>pretty_month_year</em> function that will change things like
&#8216;1990-01&#8217; to &#8216;January 1990&#8217;</p>
<p>This view definition will produce this:</p>
<a class="reference internal image-reference" href="_images/grouped_chart.png"><img alt="_images/grouped_chart.png" src="_images/grouped_chart.png" style="width: 100%;" /></a>
<p>You can create your own aggregation functions and <em>decorate</em> them for automatic labeling (and babel).
Has an example let&#8217;s look at F.A.B.&#8217;s code for <em>aggregate_sum</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@aggregate</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Count of&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">aggregate_count</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
</pre></div>
</div>
<p>The label &#8216;Count of&#8217; will be concatenated to your definition of <em>label_columns</em> or the pretty version generated
by the framework of the columns them selfs.</p>
</div>
<div class="section" id="deprecated-define-your-chart-views-views-py">
<h2>(Deprecated) Define your Chart Views (views.py)<a class="headerlink" href="#deprecated-define-your-chart-views-views-py" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ContactChartView</span><span class="p">(</span><span class="n">ChartView</span><span class="p">):</span>
    <span class="n">search_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">,</span><span class="s">&#39;contact_group&#39;</span><span class="p">]</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">Contact</span><span class="p">)</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="s">&#39;Grouped contacts&#39;</span>
    <span class="n">label_columns</span> <span class="o">=</span> <span class="n">ContactModelView</span><span class="o">.</span><span class="n">label_columns</span>
    <span class="n">group_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;contact_group&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Notice that:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">label_columns:</th><td class="field-body">Are the labels that will be displayed instead of the model&#8217;s columns name. In this case they are the same labels from ContactModelView.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">group_by_columns:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">Is a list of columns that you want to group.</td>
</tr>
</tbody>
</table>
<p>this will produce a Pie chart, with the percentage of contacts by group.
If you want a column chart just define:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chart_type</span> <span class="o">=</span> <span class="s">&#39;ColumnChart&#39;</span>
</pre></div>
</div>
<p>You can use &#8216;BarChart&#8217;, &#8216;LineChart&#8217;, &#8216;AreaChart&#8217; the default is &#8216;PieChart&#8217;, take a look at the google charts documentation, the <em>chart_type</em> is the function on &#8216;google.visualization&#8217; object</p>
<p>Let&#8217;s define a chart grouped by a time frame?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ContactTimeChartView</span><span class="p">(</span><span class="n">TimeChartView</span><span class="p">):</span>
    <span class="n">search_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">,</span><span class="s">&#39;contact_group&#39;</span><span class="p">]</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="s">&#39;Grouped Birth contacts&#39;</span>
    <span class="n">label_columns</span> <span class="o">=</span> <span class="n">ContactModelView</span><span class="o">.</span><span class="n">label_columns</span>
    <span class="n">group_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;birthday&#39;</span><span class="p">]</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">Contact</span><span class="p">)</span>
</pre></div>
</div>
<p>this will produce a column chart, with the number of contacts that were born on a particular month or year.
Notice that the label_columns are from and already defined <em>ContactModelView</em> take a look at the <a class="reference internal" href="quickhowto.html"><em>Model Views (Quick How to)</em></a></p>
<p>Finally we will define a direct data chart</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">StatsChartView</span><span class="p">(</span><span class="n">DirectChartView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">Stats</span><span class="p">)</span>
    <span class="n">chart_title</span> <span class="o">=</span> <span class="n">lazy_gettext</span><span class="p">(</span><span class="s">&#39;Statistics&#39;</span><span class="p">)</span>
    <span class="n">direct_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Some Stats&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s">&#39;stat1&#39;</span><span class="p">,</span> <span class="s">&#39;col1&#39;</span><span class="p">,</span> <span class="s">&#39;col2&#39;</span><span class="p">),</span>
                    <span class="s">&#39;Other Stats&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s">&#39;stat2&#39;</span><span class="p">,</span> <span class="s">&#39;col3&#39;</span><span class="p">)}</span>
</pre></div>
</div>
<p>direct_columns is a dictionary you define to identify a label for your X column, and the Y columns (series) you want to include on the chart</p>
<p>This dictionary is composed by key and a tuple: {&#8216;KEY LABEL FOR X COL&#8217;:(&#8216;X COL&#8217;,&#8217;Y COL&#8217;,&#8217;Y2 COL&#8217;,...),...}</p>
<p>Remember &#8216;X COL&#8217;, &#8216;Ys COL&#8217; are identifying columns from the data model.</p>
<p>Take look at a more detailed example on <a class="reference external" href="https://github.com/dpgaspar/Flask-AppBuilder/tree/master/examples/quickcharts">quickcharts</a>.</p>
</div>
<div class="section" id="register-views-py">
<h2>Register (views.py)<a class="headerlink" href="#register-views-py" title="Permalink to this headline">¶</a></h2>
<p>Register everything, to present your charts and create the menu:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">ContactTimeChartView</span><span class="p">,</span> <span class="s">&quot;Contacts Birth Chart&quot;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s">&quot;fa-envelope&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s">&quot;Contacts&quot;</span><span class="p">)</span>
<span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">ContactChartView</span><span class="p">,</span> <span class="s">&quot;Contacts Chart&quot;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s">&quot;fa-dashboard&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s">&quot;Contacts&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can find this example at: <a class="reference external" href="https://github.com/dpgaspar/Flask-AppBuilder/tree/master/examples/quickhowto">https://github.com/dpgaspar/Flask-AppBuilder/tree/master/examples/quickhowto</a></p>
<p>Take a look at the <a class="reference internal" href="api.html"><em>API Reference</em></a>. For additional customization</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use charts has related views also, just add them on your related_views properties.</p>
</div>
<p>Some images:</p>
<a class="reference internal image-reference" href="_images/chart.png"><img alt="_images/chart.png" src="_images/chart.png" style="width: 100%;" /></a>
<a class="reference internal image-reference" href="_images/chart_time1.png"><img alt="_images/chart_time1.png" src="_images/chart_time1.png" style="width: 100%;" /></a>
<a class="reference internal image-reference" href="_images/chart_time2.png"><img alt="_images/chart_time2.png" src="_images/chart_time2.png" style="width: 100%;" /></a>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013, Daniel Vaz Gaspar.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>